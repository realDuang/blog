<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-rc.9">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <title>MongoDB 极简实践入门 | 枫之谷</title><meta name="description" content="这个人很懒，但还是想留下些什么东西。">
    <link rel="preload" href="/assets/style-BtB9LtaP.css" as="style"><link rel="stylesheet" href="/assets/style-BtB9LtaP.css">
    <link rel="modulepreload" href="/assets/app-BgGkuvCY.js"><link rel="modulepreload" href="/assets/2017-09-17.html-B1f1WzxM.js">
    <link rel="prefetch" href="/assets/timeline.html-Cn8bhDE4.js" as="script"><link rel="prefetch" href="/assets/posts.html-B6t6JKP8.js" as="script"><link rel="prefetch" href="/assets/friendship-link.html-D-eFWxnV.js" as="script"><link rel="prefetch" href="/assets/1.html-PVCFxL6z.js" as="script"><link rel="prefetch" href="/assets/1.html-CRXhho0s.js" as="script"><link rel="prefetch" href="/assets/1.html-DX4wYKRD.js" as="script"><link rel="prefetch" href="/assets/1.html-D8JM2DeF.js" as="script"><link rel="prefetch" href="/assets/1.html-BFIiSqe_.js" as="script"><link rel="prefetch" href="/assets/1.html-gkRBPO0p.js" as="script"><link rel="prefetch" href="/assets/2.html-B7vjw85q.js" as="script"><link rel="prefetch" href="/assets/1.html-BrXUIYYn.js" as="script"><link rel="prefetch" href="/assets/1.html-CR7wfxKh.js" as="script"><link rel="prefetch" href="/assets/1.html-KunaIYJb.js" as="script"><link rel="prefetch" href="/assets/1.html-CW4IGnDN.js" as="script"><link rel="prefetch" href="/assets/1.html-BsyF5aXx.js" as="script"><link rel="prefetch" href="/assets/1.html-CdB_HygG.js" as="script"><link rel="prefetch" href="/assets/1.html-CFNwYuwf.js" as="script"><link rel="prefetch" href="/assets/1.html-CEdNgyIl.js" as="script"><link rel="prefetch" href="/assets/1.html-CTwUviG1.js" as="script"><link rel="prefetch" href="/assets/1.html-ei1PI0vl.js" as="script"><link rel="prefetch" href="/assets/1.html-T92Pp9kj.js" as="script"><link rel="prefetch" href="/assets/1.html-4hRs0jQD.js" as="script"><link rel="prefetch" href="/assets/1.html-BatqFs6i.js" as="script"><link rel="prefetch" href="/assets/1.html-BQWHx0Cw.js" as="script"><link rel="prefetch" href="/assets/1.html-C5MpIt8R.js" as="script"><link rel="prefetch" href="/assets/1.html-BQWkV3KU.js" as="script"><link rel="prefetch" href="/assets/1.html-DdBr9RRC.js" as="script"><link rel="prefetch" href="/assets/1.html-D2rqCw2j.js" as="script"><link rel="prefetch" href="/assets/1.html-2AeziTs2.js" as="script"><link rel="prefetch" href="/assets/1.html-C9OJ1_gO.js" as="script"><link rel="prefetch" href="/assets/1.html-V-bI7nc-.js" as="script"><link rel="prefetch" href="/assets/1.html-B2It7BfI.js" as="script"><link rel="prefetch" href="/assets/1.html-Dcu1qNci.js" as="script"><link rel="prefetch" href="/assets/1.html-COrtiFUK.js" as="script"><link rel="prefetch" href="/assets/1.html-BdhUuM_8.js" as="script"><link rel="prefetch" href="/assets/2.html-COTIt_-R.js" as="script"><link rel="prefetch" href="/assets/1.html-BWDy5Fbx.js" as="script"><link rel="prefetch" href="/assets/1.html-L25yMNJM.js" as="script"><link rel="prefetch" href="/assets/1.html-CGUMMJUA.js" as="script"><link rel="prefetch" href="/assets/1.html-CtN8qYNW.js" as="script"><link rel="prefetch" href="/assets/1.html-9NeugzHL.js" as="script"><link rel="prefetch" href="/assets/1.html-BuBHXo4K.js" as="script"><link rel="prefetch" href="/assets/1.html-B7d2Owm2.js" as="script"><link rel="prefetch" href="/assets/1.html-DSNDgB5z.js" as="script"><link rel="prefetch" href="/assets/1.html-DeR2FTxI.js" as="script"><link rel="prefetch" href="/assets/1.html-CSS02TUS.js" as="script"><link rel="prefetch" href="/assets/1.html-DQjaKR-4.js" as="script"><link rel="prefetch" href="/assets/1.html-CZ8SkAOh.js" as="script"><link rel="prefetch" href="/assets/2.html-B86OCfvx.js" as="script"><link rel="prefetch" href="/assets/3.html-CopKwpZ8.js" as="script"><link rel="prefetch" href="/assets/4.html-DiSlNSE0.js" as="script"><link rel="prefetch" href="/assets/5.html-VSomvgqd.js" as="script"><link rel="prefetch" href="/assets/index.html-BuRcgGca.js" as="script"><link rel="prefetch" href="/assets/2021-05-07.html-Cfbj1KGC.js" as="script"><link rel="prefetch" href="/assets/2016-10-16.html-Bn6LDFY3.js" as="script"><link rel="prefetch" href="/assets/2019-09-20.html-rwlbH_Pe.js" as="script"><link rel="prefetch" href="/assets/2019-09-23.html-3cfm4JDM.js" as="script"><link rel="prefetch" href="/assets/2019-09-26.html-C8K81z3C.js" as="script"><link rel="prefetch" href="/assets/2019-10-07.html-ClA6sB96.js" as="script"><link rel="prefetch" href="/assets/2022-09-08.html-DnOkJ17R.js" as="script"><link rel="prefetch" href="/assets/ 2017-11-30.html-i-gqp4Co.js" as="script"><link rel="prefetch" href="/assets/2017-02-10.html-BGIYeC0z.js" as="script"><link rel="prefetch" href="/assets/2017-02-20.html-CCI4rLCC.js" as="script"><link rel="prefetch" href="/assets/2017-04-16.html-DkBE5ZlK.js" as="script"><link rel="prefetch" href="/assets/2017-05-25.html-Dfxyq_dw.js" as="script"><link rel="prefetch" href="/assets/2017-12-01.html-BRtlIR1a.js" as="script"><link rel="prefetch" href="/assets/2017-12-03.html-BL7aKnPg.js" as="script"><link rel="prefetch" href="/assets/2017-12-04.html-CAIlHhbH.js" as="script"><link rel="prefetch" href="/assets/2018-03-14.html-MjjU0jmy.js" as="script"><link rel="prefetch" href="/assets/2018-11-12.html-DPNjq1MG.js" as="script"><link rel="prefetch" href="/assets/2019-12-21.html-DWpCxdXh.js" as="script"><link rel="prefetch" href="/assets/2020-01-21.html-NzPW3Tg0.js" as="script"><link rel="prefetch" href="/assets/2020-06-16.html-BYuOdfet.js" as="script"><link rel="prefetch" href="/assets/2020-07-13.html-CZvE2nQ7.js" as="script"><link rel="prefetch" href="/assets/2020-11-02.html-pDv7wIyI.js" as="script"><link rel="prefetch" href="/assets/2021-05-11.html-CgO0_Iua.js" as="script"><link rel="prefetch" href="/assets/2021-07-25.html-CSowoMO8.js" as="script"><link rel="prefetch" href="/assets/2022-01-25.html-DuVehU2l.js" as="script"><link rel="prefetch" href="/assets/2022-03-15.html-Ci0xvkLU.js" as="script"><link rel="prefetch" href="/assets/2023-08-21.html-RxmCuwJy.js" as="script"><link rel="prefetch" href="/assets/2024-05-07.html-DztddKDo.js" as="script"><link rel="prefetch" href="/assets/2017-01-05.html-BS47UWU8.js" as="script"><link rel="prefetch" href="/assets/2017-05-12.html-DRoqk81W.js" as="script"><link rel="prefetch" href="/assets/2017-06-11.html-CMCphmHj.js" as="script"><link rel="prefetch" href="/assets/2017-07-02.html-BZlCcV9g.js" as="script"><link rel="prefetch" href="/assets/2018-01-03.html-DYZ3HhX0.js" as="script"><link rel="prefetch" href="/assets/2021-02-01.html-DidKd2bm.js" as="script"><link rel="prefetch" href="/assets/2021-03-13.html-C9VTxymg.js" as="script"><link rel="prefetch" href="/assets/0.introductory.html-GMvAwxmH.js" as="script"><link rel="prefetch" href="/assets/1.inter-process-communication.html-DSfBdlM6.js" as="script"><link rel="prefetch" href="/assets/2.server-module-design.html-BgbnPkaM.js" as="script"><link rel="prefetch" href="/assets/3.dependency-injection-design.html-AU-AWdt5.js" as="script"><link rel="prefetch" href="/assets/4.extension-loading-mechanism.html-BoKs7CIN.js" as="script"><link rel="prefetch" href="/assets/di-framework-life-cycle.html-fs0VCH29.js" as="script"><link rel="prefetch" href="/assets/multi-instance-service-management-in-di-framework.html-Cf7x2Hiz.js" as="script"><link rel="prefetch" href="/assets/index.html-BaQh4ZtR.js" as="script"><link rel="prefetch" href="/assets/index.html-OP-Orz6R.js" as="script"><link rel="prefetch" href="/assets/404.html-CITnAIio.js" as="script"><link rel="prefetch" href="/assets/reco-valine-BI2JzRng.js" as="script"><link rel="prefetch" href="/assets/giscus-aTimukGI-CKTvSCx2.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><div class="common-wrapper series--no show-catalog"><header class="navbar-container" style="top:0;"><div class="site-brand nav-item"><img class="logo" src="/avatar.jpg" alt="枫之谷"><a href="/" class="site-name can-hide">枫之谷</a></div><div class="nav-item navbar-links-wrapper" style=""><div><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form></div><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="Home"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16.612 2.214a1.01 1.01 0 0 0-1.242 0L1 13.419l1.243 1.572L4 13.621V26a2.004 2.004 0 0 0 2 2h20a2.004 2.004 0 0 0 2-2V13.63L29.757 15L31 13.428zM18 26h-4v-8h4zm2 0v-8a2.002 2.002 0 0 0-2-2h-4a2.002 2.002 0 0 0-2 2v8H6V12.062l10-7.79l10 7.8V26z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Home<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/timeline.html" class="link" aria-label="时间轴"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M23.586 13L21 10.414V6h2v3.586l2 2L23.586 13z" fill="currentColor"></path><path d="M22 18a8 8 0 1 1 8-8a8.01 8.01 0 0 1-8 8zm0-14a6 6 0 1 0 6 6a6.007 6.007 0 0 0-6-6z" fill="currentColor"></path><path d="M8.63 18l7 6H30v-2H16.37l-7-6H4V2H2v26a2.002 2.002 0 0 0 2 2h26v-2H4V18z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->时间轴<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a class="link" href="https://blog.realduang.com/rss.xml" target="_blank" rel="noopener noreferrer" aria-label="订阅"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M8 18c-3.3 0-6 2.7-6 6s2.7 6 6 6s6-2.7 6-6s-2.7-6-6-6zm0 10c-2.2 0-4-1.8-4-4s1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4z" fill="currentColor"></path><path d="M30 24h-2C28 13 19 4 8 4V2c12.1 0 22 9.9 22 22z" fill="currentColor"></path><path d="M22 24h-2c0-6.6-5.4-12-12-12v-2c7.7 0 14 6.3 14 14z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->订阅<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/docs/message-board/" class="link" aria-label="留言板"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M17.74 30L16 29l4-7h6a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h9v2H6a4 4 0 0 1-4-4V8a4 4 0 0 1 4-4h20a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4h-4.84z" fill="currentColor"></path><path d="M8 10h16v2H8z" fill="currentColor"></path><path d="M8 16h10v2H8z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->留言板<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="更多"><span class="xicon-container left title"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M25 10H7a3.003 3.003 0 0 0-3 3v6a2.002 2.002 0 0 0 2 2v7a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2V16h-2v12H8v-9H6v-6a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6h-2v9h-4V16h-2v12a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2v-7a2.002 2.002 0 0 0 2-2v-6a3.003 3.003 0 0 0-3-3z" fill="currentColor"></path><path d="M10 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path><path d="M22 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->更多<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="更多"><span class="title"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M25 10H7a3.003 3.003 0 0 0-3 3v6a2.002 2.002 0 0 0 2 2v7a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2V16h-2v12H8v-9H6v-6a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6h-2v9h-4V16h-2v12a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2v-7a2.002 2.002 0 0 0 2-2v-6a3.003 3.003 0 0 0-3-3z" fill="currentColor"></path><path d="M10 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path><path d="M22 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->更多<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a class="link" href="https://realDuang.github.io/leetcode-in-javascript/" target="_blank" rel="noopener noreferrer" aria-label="Leetcode In JavaScript"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Leetcode In JavaScript<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a href="/docs/about/" class="link" aria-label="关于我"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M6 21v-1H4v1a7 7 0 0 0 7 7h3v-2h-3a5 5 0 0 1-5-5z" fill="currentColor"></path><path d="M24 11v1h2v-1a7 7 0 0 0-7-7h-3v2h3a5 5 0 0 1 5 5z" fill="currentColor"></path><path d="M11 11H5a3 3 0 0 0-3 3v2h2v-2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2h2v-2a3 3 0 0 0-3-3z" fill="currentColor"></path><path d="M8 10a4 4 0 1 0-4-4a4 4 0 0 0 4 4zm0-6a2 2 0 1 1-2 2a2 2 0 0 1 2-2z" fill="currentColor"></path><path d="M27 25h-6a3 3 0 0 0-3 3v2h2v-2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2h2v-2a3 3 0 0 0-3-3z" fill="currentColor"></path><path d="M20 20a4 4 0 1 0 4-4a4 4 0 0 0-4 4zm6 0a2 2 0 1 1-2-2a2 2 0 0 1 2 2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->关于我<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a class="link" href="https://github.com/realDuang/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->GitHub<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><span class="xicon-container btn-toggle-dark-mode btn--dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></span><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div></header><!----><div class="mobile-menus-container"><nav class="navbar-links mobile"><!--[--><div class="navbar-links__item"><a href="/" class="link" aria-label="Home"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16.612 2.214a1.01 1.01 0 0 0-1.242 0L1 13.419l1.243 1.572L4 13.621V26a2.004 2.004 0 0 0 2 2h20a2.004 2.004 0 0 0 2-2V13.63L29.757 15L31 13.428zM18 26h-4v-8h4zm2 0v-8a2.002 2.002 0 0 0-2-2h-4a2.002 2.002 0 0 0-2 2v8H6V12.062l10-7.79l10 7.8V26z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Home<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/timeline.html" class="link" aria-label="时间轴"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M23.586 13L21 10.414V6h2v3.586l2 2L23.586 13z" fill="currentColor"></path><path d="M22 18a8 8 0 1 1 8-8a8.01 8.01 0 0 1-8 8zm0-14a6 6 0 1 0 6 6a6.007 6.007 0 0 0-6-6z" fill="currentColor"></path><path d="M8.63 18l7 6H30v-2H16.37l-7-6H4V2H2v26a2.002 2.002 0 0 0 2 2h26v-2H4V18z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->时间轴<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a class="link" href="https://blog.realduang.com/rss.xml" target="_blank" rel="noopener noreferrer" aria-label="订阅"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M8 18c-3.3 0-6 2.7-6 6s2.7 6 6 6s6-2.7 6-6s-2.7-6-6-6zm0 10c-2.2 0-4-1.8-4-4s1.8-4 4-4s4 1.8 4 4s-1.8 4-4 4z" fill="currentColor"></path><path d="M30 24h-2C28 13 19 4 8 4V2c12.1 0 22 9.9 22 22z" fill="currentColor"></path><path d="M22 24h-2c0-6.6-5.4-12-12-12v-2c7.7 0 14 6.3 14 14z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->订阅<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a href="/docs/message-board/" class="link" aria-label="留言板"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M17.74 30L16 29l4-7h6a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h9v2H6a4 4 0 0 1-4-4V8a4 4 0 0 1 4-4h20a4 4 0 0 1 4 4v12a4 4 0 0 1-4 4h-4.84z" fill="currentColor"></path><path d="M8 10h16v2H8z" fill="currentColor"></path><path d="M8 16h10v2H8z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->留言板<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="更多"><span class="xicon-container left title"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M25 10H7a3.003 3.003 0 0 0-3 3v6a2.002 2.002 0 0 0 2 2v7a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2V16h-2v12H8v-9H6v-6a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6h-2v9h-4V16h-2v12a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2v-7a2.002 2.002 0 0 0 2-2v-6a3.003 3.003 0 0 0-3-3z" fill="currentColor"></path><path d="M10 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path><path d="M22 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->更多<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="更多"><span class="title"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M25 10H7a3.003 3.003 0 0 0-3 3v6a2.002 2.002 0 0 0 2 2v7a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2V16h-2v12H8v-9H6v-6a1 1 0 0 1 1-1h18a1 1 0 0 1 1 1v6h-2v9h-4V16h-2v12a2.002 2.002 0 0 0 2 2h4a2.002 2.002 0 0 0 2-2v-7a2.002 2.002 0 0 0 2-2v-6a3.003 3.003 0 0 0-3-3z" fill="currentColor"></path><path d="M10 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path><path d="M22 9a4 4 0 1 1 4-4a4.004 4.004 0 0 1-4 4zm0-6a2 2 0 1 0 2 2a2.002 2.002 0 0 0-2-2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->更多<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a class="link" href="https://realDuang.github.io/leetcode-in-javascript/" target="_blank" rel="noopener noreferrer" aria-label="Leetcode In JavaScript"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Leetcode In JavaScript<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a href="/docs/about/" class="link" aria-label="关于我"><!--[--><!--]--><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M6 21v-1H4v1a7 7 0 0 0 7 7h3v-2h-3a5 5 0 0 1-5-5z" fill="currentColor"></path><path d="M24 11v1h2v-1a7 7 0 0 0-7-7h-3v2h3a5 5 0 0 1 5 5z" fill="currentColor"></path><path d="M11 11H5a3 3 0 0 0-3 3v2h2v-2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2h2v-2a3 3 0 0 0-3-3z" fill="currentColor"></path><path d="M8 10a4 4 0 1 0-4-4a4 4 0 0 0 4 4zm0-6a2 2 0 1 1-2 2a2 2 0 0 1 2-2z" fill="currentColor"></path><path d="M27 25h-6a3 3 0 0 0-3 3v2h2v-2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2h2v-2a3 3 0 0 0-3-3z" fill="currentColor"></path><path d="M20 20a4 4 0 1 0 4-4a4 4 0 0 0-4 4zm6 0a2 2 0 1 1-2-2a2 2 0 0 1 2 2z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->关于我<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><a class="link" href="https://github.com/realDuang/blog" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->GitHub<!--]--></span></span><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><div class="appearance"><span>Appearance</span><span class="xicon-container btn-toggle-dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></span></div></div><div class="series-mask"></div><aside class="series-container"><div class="site-brand"><img class="logo" src="/avatar.jpg" alt="枫之谷"><a href="/" class="site-name can-hide">枫之谷</a></div><!--[--><!--]--></aside><!--[--><main class="page-container"><h1 class="page-title">MongoDB 极简实践入门</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Duang<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2017-09-17 17:13:38<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M11.17 6l3.42 3.41l.58.59H28v16H4V6h7.17m0-2H4a2 2 0 0 0-2 2v20a2 2 0 0 0 2 2h24a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2H16l-3.41-3.41A2 2 0 0 0 11.17 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/categories/qianduanjishuyanjiuyuan/1.html" class="">前端技术研究院</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M10 14a4 4 0 1 1 4-4a4.005 4.005 0 0 1-4 4zm0-6a2 2 0 1 0 1.998 2.004A2.002 2.002 0 0 0 10 8z" fill="currentColor"></path><path d="M16.644 29.415L2.586 15.354A2 2 0 0 1 2 13.941V4a2 2 0 0 1 2-2h9.941a2 2 0 0 1 1.414.586l14.06 14.058a2 2 0 0 1 0 2.828l-9.943 9.943a2 2 0 0 1-2.829 0zM4 4v9.942L18.058 28L28 18.058L13.942 4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!--[--><a href="/tags/MongoDB/1.html" class="">MongoDB</a><!--]--><!--]--></span></span><span class="xicon-container left"><!--[--><svg class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 12 12"><g fill="none"><path d="M1.974 6.659a.5.5 0 0 1-.948-.317c-.01.03 0-.001 0-.001a1.633 1.633 0 0 1 .062-.162c.04-.095.099-.226.18-.381c.165-.31.422-.723.801-1.136C2.834 3.827 4.087 3 6 3c1.913 0 3.166.827 3.931 1.662a5.479 5.479 0 0 1 .98 1.517l.046.113c.003.008.013.06.023.11L11 6.5s.084.333-.342.474a.5.5 0 0 1-.632-.314v-.003l-.006-.016a3.678 3.678 0 0 0-.172-.376a4.477 4.477 0 0 0-.654-.927C8.584 4.673 7.587 4 6 4s-2.584.673-3.194 1.338a4.477 4.477 0 0 0-.795 1.225a2.209 2.209 0 0 0-.03.078l-.007.018zM6 5a2 2 0 1 0 0 4a2 2 0 0 0 0-4zM5 7a1 1 0 1 1 2 0a1 1 0 0 1-2 0z" fill="currentColor"></path></g></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[--><!----><span class="waline-pageview-count" data-path="/blogs/frontend-tech-institute/2017-09-17.html"></span><!--]--></span></span></div><div class="theme-reco-default-content"><div><h2 id="为什么用-mongodb" tabindex="-1"><a class="header-anchor" href="#为什么用-mongodb"><span>为什么用 MongoDB</span></a></h2><p>传统的计算机应用大多使用关系型数据库来存储数据，比如大家可能熟悉的 MySql, Sqlite 等等，它的特点是数据以表格 (table) 的形式储存起来的。数据库由一张张排列整齐的表格构成，就好像一个 Excel 表单一样，每个表格会有若干列，比如一个学生信息表，可能包含学号、姓名、性别、入学年份、高考成绩、籍贯等等。而表格的每一排，则是一个个学生的具体信息。在企业级应用和前互联网时代，关系型数据库几乎是不二选择。关系型数据库的特点是有整齐划一的组织，很方便对数据进行描述、插入、搜索。</p><p>想象有一个传统的网上服装商店吧，它的主要的数据可能是储存在一张叫 products 的表单里，表单可能包含这些列：商品编号 (ID)、名称 (Name)、商家 (brand)、主目录 (cate)、子目录 (sub-cat)、零售价 (price)、是否促销 (promotion) 等等。如果有一个用户想要查找所有价格低于 300 元的正在促销的鞋子的编号和名称，则可以执行类似于以下的 SQL 语句：</p><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> ID<span class="token punctuation">,</span> name <span class="token keyword">FROM</span> products <span class="token keyword">WHERE</span> cate<span class="token operator">=</span><span class="token string">&#39;shoes&#39;</span> <span class="token operator">AND</span> price<span class="token operator">&lt;</span><span class="token number">300</span> <span class="token operator">and</span> <span class="token operator">AND</span> promotion<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>SQL 具备了强大了的深度查询能力，能满足各式各样的查询要求。而如果要对数据进行添加和删除，成本也是非常低的。这些是 SQL 的优势之一， 但随着互联网的兴起以及数据形式的多样化，四平八稳的 SQL 表单在一些领域渐渐显现出它的劣势。让我们通过一个例子来说明。考虑一个博客后台系统，如果我们用关系型数据库为每篇博客 (article) 建一个表单的话，这个表单大概会包括以下这些列：</p><table><thead><tr><th>ID</th><th style="text-align:center;">Title</th><th style="text-align:center;">Description</th><th style="text-align:center;">Author</th><th style="text-align:center;">Content</th><th style="text-align:center;">Likes</th></tr></thead><tbody><tr><td>A_1</td><td style="text-align:center;">Title1</td><td style="text-align:center;">Political Article</td><td style="text-align:center;">Joe</td><td style="text-align:center;">Content 1</td><td style="text-align:center;">12</td></tr><tr><td>A_2</td><td style="text-align:center;">Title2</td><td style="text-align:center;">Humorous Story</td><td style="text-align:center;">Sam</td><td style="text-align:center;">Content 2</td><td style="text-align:center;">50</td></tr></tbody></table><p>这时候用 SQL 数据库来存储是非常方便的，但假如我们要位每篇文章添加评论功能，会发现每篇文章可能要多篇评论，而且这个数目是动态变化的，而且每篇评论还包括好几项内容：评论的人、评论的时间、以及评论内容。这时候要将这些内容都塞进上述的那个表，就显得很困难。通常的做法是为评论 (comment) 单独建一个表：</p><table><thead><tr><th>ID</th><th style="text-align:center;">Author</th><th style="text-align:center;">Time</th><th style="text-align:center;">Content</th><th style="text-align:center;">Article</th></tr></thead><tbody><tr><td>C_1</td><td style="text-align:center;">Anna</td><td style="text-align:center;">2014-12-26 08:23</td><td style="text-align:center;">Really good articles!</td><td style="text-align:center;">A_1</td></tr><tr><td>C_2</td><td style="text-align:center;">David</td><td style="text-align:center;">2014-12-25 09:30</td><td style="text-align:center;">I like it!</td><td style="text-align:center;">A_1</td></tr></tbody></table><p>类似地，每篇文章可能会有若干标签 (tags)。标签本身又是一个表单：</p><table><thead><tr><th>ID</th><th style="text-align:center;">Category</th><th style="text-align:center;">Tags</th><th style="text-align:center;">Content</th><th style="text-align:center;">Article</th></tr></thead><tbody><tr><td>T_1</td><td style="text-align:center;">Anna</td><td style="text-align:center;">2014-12-26 08:23</td><td style="text-align:center;">Really good articles!</td><td style="text-align:center;">A_1</td></tr><tr><td>T_2</td><td style="text-align:center;">David</td><td style="text-align:center;">2014-12-25 09:30</td><td style="text-align:center;">I like it!</td><td style="text-align:center;">A_2</td></tr></tbody></table><p>而博客的表格则要通过 foreign key 跟这些相关联的表格联系起来(可能还包括作者、出版社等其它表格)。这样一来，当我们做查询的时候，比如说，“找出评论数不少于 3 的标签为‘政治评论’的作者为 Sam 的文章”，就会涉及到复杂的跨表查询，需要大量使用<code>join</code>语句。这种跨表查询不仅降低了查询速度，而且这些语句写起来也不简单。</p><p>那么，如果用 MongoDB 数据库来实现，可以如何设计数据模型呢？很简单，像下面这样 <a href="http://www.tutorialspoint.com/mongodb/mongodb_data_modeling.htm" target="_blank" rel="noopener noreferrer">http://www.tutorialspoint.com/mongodb/mongodb_data_modeling.htm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code> _id<span class="token operator">:</span> POST_ID
 title<span class="token operator">:</span> TITLE_OF_POST<span class="token punctuation">,</span>
 description<span class="token operator">:</span> POST_DESCRIPTION<span class="token punctuation">,</span>
 author<span class="token operator">:</span> POST_BY<span class="token punctuation">,</span>
 tags<span class="token operator">:</span> <span class="token punctuation">[</span>TAG1<span class="token punctuation">,</span> TAG2<span class="token punctuation">,</span> TAG3<span class="token punctuation">]</span><span class="token punctuation">,</span>
 likes<span class="token operator">:</span> TOTAL_LIKES<span class="token punctuation">,</span>
 comments<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
       user<span class="token operator">:</span>&#39;COMMENT_BY&#39;<span class="token punctuation">,</span>
       message<span class="token operator">:</span> TEXT<span class="token punctuation">,</span>
       dateCreated<span class="token operator">:</span> DATE_TIME<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
       user<span class="token operator">:</span>&#39;COMMENT_BY&#39;<span class="token punctuation">,</span>
       message<span class="token operator">:</span> TEXT<span class="token punctuation">,</span>
       dateCreated<span class="token operator">:</span> DATE_TIME<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
 <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 MongoDB 里，每篇博客文章以一个文档 (document) 的形式保存起来，而文档内部包含了很多项目，比如<code>title tags</code>等，每一个项目都是<code>key-value</code>的形式，即有一个项目的名字，比如<code>title</code>，以及它的值<code>TITLE_OF_POST</code>。而重要的是，一个<code>key</code>可以有多个<code>values</code>，他们用<code>[]</code>括起来。</p><p>这种“宽松”的数据存储形式非常灵活，MongoDB 不限制每个<code>key</code>对应的<code>values</code>的数目。比如有的文章没有评论，则它的值就是一个空集，完全没有问题；有的文章评论很多，也可以无限制地插入。更灵活的是，MongoDB 不要求同一个集合 (collection，相当于 SQL 的 table) 里面的不同 document 有相同的 key，比如除了上述这种文档组织，有的文档所代表的文章可能没有 likes 这个项目，再比如有的文章可能有更多的项目，比如可能还有 dislikes 等等。这些不同的文档都可以灵活地存储在同一个集合下，而且查询起来也异常简单，因为都在一个文档里，不用进行各种跨文档查询。而这种 MongoDB 式的存储也方便了数据的维护，对于一篇博客文章来说，所有的相关数据都在这个 document 里面，不用去考虑一个数据操作需要 involve 多少个表格。</p><p>当然，除了上述的优点，MongoDB 还有不少别的优势，比如 MongoDB 的数据是用 JSON(Javascript Object Notation) 存储的(就是上面的这种 key-value 的形式)，而几乎所有的 web 应用都是基于 Javascript 的。因此，存储的数据和应用的数据的格式是高度一致的，不需经过转换。更多的优点可以查看：<a href="http://www.tutorialspoint.com/mongodb/mongodb_advantages.htm" target="_blank" rel="noopener noreferrer">http://www.tutorialspoint.com/mongodb/mongodb_advantages.htm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h2 id="文章目的" tabindex="-1"><a class="header-anchor" href="#文章目的"><span>文章目的</span></a></h2><p>这个极简教程，或者说笔记，并不是一个覆盖 MongoDB 方方面面的教程。所谓极简的意思，就是只选取那些最重要、最常用的内容进行基于实例的介绍，从而让读者能够在最短的时间内快速上手，并且能顺利地进行后续的纵深的学习。</p><p>具体地说，这个教程的特点是：</p><ul><li>不求全面，只求实用。只覆盖最核心的部分；</li><li>以大量例子为导向；</li><li>一边阅读一边动手操作的话，大约只需要 2 小时的时间；</li></ul><p>阅读这篇文章不需要有特别的基础，但最好知道数据库的基本概念，如果本身熟悉 SQL 那就更好啦。</p><h3 id="安装与环境" tabindex="-1"><a class="header-anchor" href="#安装与环境"><span>安装与环境</span></a></h3><p>MongoDB 可以在 Windows、Linux、Mac OS X 等主流平台运行，而且下载和安装非常简单，非常友好。这篇文档的例子采用 MongoDB 2.6 版本，均在 OS X 测试过，有充足的理由相信，在其它平台也能顺利运行。</p><p>Windows 的安装和设置可以参考：<a href="http://www.w3cschool.cc/mongodb/mongodb-window-install.html" target="_blank" rel="noopener noreferrer">http://www.w3cschool.cc/mongodb/mongodb-window-install.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Linux 的安装和设置可以参考：<a href="http://www.w3cschool.cc/mongodb/mongodb-linux-install.html" target="_blank" rel="noopener noreferrer">http://www.w3cschool.cc/mongodb/mongodb-linux-install.html<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>Mac OS X 下的安装和设置：</p><ol><li>在 <a href="https://www.mongodb.org/" target="_blank" rel="noopener noreferrer">https://www.mongodb.org/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 下载适合你的 Mac 的 MongoDb;</li><li>下载得到的文件是一个 zip 文件，解压，然后放到你想到的文件夹，比如/Users/Steven/MongoDB;</li><li>创建一个你喜欢的文件夹来存储你的数据，比如/User/Steven/myData;</li><li>打开 Terminal，cd 到 2 里面那个文件夹/Users/Steven/MongoDB，再 cd bin;</li><li>输入。/mongod --dbpath /User/Steven/myData, 等到出现类似“waiting for connections on port 27017”，说明 MongoDB 服务器已架设好，而数据将储存在 myData 里面；</li><li>新打开一个 Terminal, cd /Users/Steven/MongoDB/bin, 然后运行。/mongo; 顺利的话它将出现一个 interactive shell 让你进行各种操作，而你的数据将储存在 myData 里</li></ol><p>如果以上的各个步骤都运行顺利，就可以跳到下一节啦。</p><h3 id="创建集合和删除集合" tabindex="-1"><a class="header-anchor" href="#创建集合和删除集合"><span>创建集合和删除集合</span></a></h3><p>在上一节执行完步骤 6 后，你会看到命令行里显示：<code>connecting to: test</code>，这里的<code>test</code>是默认的数据库。这里我们可以新建一个数据库。在命令行里打入：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>use tutorial
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这样就新建了一个叫做<code>tutorial</code>的数据库。你可以执行</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>show databases
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>来显示当前的数据库。不过这时候由于我们的新数据库是空的，所以会显示类似这样的：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>admin  <span class="token punctuation">(</span>empty<span class="token punctuation">)</span>
<span class="token builtin class-name">local</span>  <span class="token number">0</span>.078GB
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>我们试着往我们的数据库里添加一个集合 (collection)，MongoDB 里的集合和 SQL 里面的表格是类似的：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.createCollection<span class="token punctuation">(</span><span class="token string">&#39;author&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>顺利的话会显示：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">{</span> <span class="token string">&quot;ok&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>表示创建成功。</p><p>你可以再回头执行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>show databases
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这时候我们的 tutorial 集合已经位列其中。你可以再执行</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>show collections
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>可以看到创建的集合 author 也在其中。</p><p>我们暂时不需要 author 这个集合，所以我们可以通过执行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.author.drop<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>来将其删除。这时候你再执行<code>show collections</code>，就再也看不到我们的 author 了。</p><p>这一节要记住的点主要只有一个：集合 (collection) 类似于 SQL 的表格 (table)，类似于 Excel 的一个个表格。</p><h3 id="插入" tabindex="-1"><a class="header-anchor" href="#插入"><span>插入</span></a></h3><p>想象一个精简版的“豆瓣电影”。我们需要创建一个数据库，来存储每部电影的信息，电影的信息包括：</p><p>电影名字<br> 导演<br> 主演(可能多个)<br> 类型标签(可能多个)<br> 上映日期<br> 喜欢人数<br> 不喜欢人数<br> 用户评论(可能多个)</p><p>显然我们需要先创建一个叫电影的集合：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.createCollection<span class="token punctuation">(</span><span class="token string">&#39;movie&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后，我们就可以插入数据了：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.insert<span class="token punctuation">(</span>
  <span class="token punctuation">{</span>
    title: <span class="token string">&#39;Forrest Gump&#39;</span>,
    directed_by: <span class="token string">&#39;Robert Zemeckis&#39;</span>,
    stars: <span class="token punctuation">[</span><span class="token string">&#39;Tom Hanks&#39;</span>, <span class="token string">&#39;Robin Wright&#39;</span>, <span class="token string">&#39;Gary Sinise&#39;</span><span class="token punctuation">]</span>,
    tags: <span class="token punctuation">[</span><span class="token string">&#39;drama&#39;</span>, <span class="token string">&#39;romance&#39;</span><span class="token punctuation">]</span>,
    debut: new Date<span class="token punctuation">(</span><span class="token number">1994,7</span>,6,0,0<span class="token punctuation">)</span>,
    likes: <span class="token number">864367</span>,
    dislikes: <span class="token number">30127</span>,
    comments: <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        user:<span class="token string">&#39;user1&#39;</span>,
        message: <span class="token string">&#39;My first comment&#39;</span>,
        dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2013,11</span>,10,2,35<span class="token punctuation">)</span>,
        like: <span class="token number">0</span>
      <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span>
        user:<span class="token string">&#39;user2&#39;</span>,
        message: <span class="token string">&#39;My first comment too!&#39;</span>,
        dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2013,11</span>,11,6,20<span class="token punctuation">)</span>,
        like: <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>请注意，这里插入数据之前，我们并不需要先声明 movie 这个集合里面有哪些项目。我们直接插入就可以了~这一点和 SQL 不一样，SQL 必须先声明一个 table 里面有哪些列，而 MongoDB 不需要。</p><p>把上面的例子复制进命令行应该可以顺利运行，但我强烈建议你手动打一下，或者输入一部你自己喜欢的电影。<code>insert</code>操作有几点需要注意：</p><ol><li>不同 key-value 需要用逗号隔开，而 key:value 中间是用冒号；</li><li>如果一个 key 有多个 value，value 要用 []。哪怕当前只有一个 value，也加上 [] 以备后续的添加；</li><li>整个“数据块”要用{}括起来；</li></ol><p>如果你在<code>insert</code>之后看到<code>WriteResult({ &quot;nInserted&quot; : 1 })</code>，说明写入成功。</p><p>这个时候你可以用查询的方式来返回数据库中的数据：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里<code>find()</code>里面是空的，说明我们不做限制和筛选，类似于 SQL 没有<code>WHERE</code>语句一样。而<code>pretty()</code>输出的是经格式美化后的数据，你可以自己试试没有<code>pretty()</code>会怎么样。</p><p>仔细观察<code>find()</code>的结果，你会发现多了一个叫<code>&#39;_id&#39;</code>的东西，这是数据库自动创建的一个 ID 号，在同一个数据库里，每个文档的 ID 号都是不同的。</p><p>我们也可以同时输入多个数据：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.insert<span class="token punctuation">(</span><span class="token punctuation">[</span>
 <span class="token punctuation">{</span>
   title: <span class="token string">&#39;Fight Club&#39;</span>,
   directed_by: <span class="token string">&#39;David Fincher&#39;</span>,
   stars: <span class="token punctuation">[</span><span class="token string">&#39;Brad Pitt&#39;</span>, <span class="token string">&#39;Edward Norton&#39;</span>, <span class="token string">&#39;Helena Bonham Carter&#39;</span><span class="token punctuation">]</span>,
   tags: <span class="token string">&#39;drama&#39;</span>,
   debut: new Date<span class="token punctuation">(</span><span class="token number">1999,10</span>,15,0,0<span class="token punctuation">)</span>,
   likes: <span class="token number">224360</span>,
   dislikes: <span class="token number">40127</span>,
   comments: <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
         user:<span class="token string">&#39;user3&#39;</span>,
         message: <span class="token string">&#39;My first comment&#39;</span>,
         dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2008,09</span>,13,2,35<span class="token punctuation">)</span>,
         like: <span class="token number">0</span>
      <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span>
         user:<span class="token string">&#39;user2&#39;</span>,
         message: <span class="token string">&#39;My first comment too!&#39;</span>,
         dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2003,10</span>,11,6,20<span class="token punctuation">)</span>,
         like: <span class="token number">14</span>
      <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span>
         user:<span class="token string">&#39;user7&#39;</span>,
         message: <span class="token string">&#39;Good Movie!&#39;</span>,
         dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2009,10</span>,11,6,20<span class="token punctuation">)</span>,
         like: <span class="token number">2</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>,
<span class="token punctuation">{</span>
   title: <span class="token string">&#39;Seven&#39;</span>,
   directed_by: <span class="token string">&#39;David Fincher&#39;</span>,
   stars: <span class="token punctuation">[</span><span class="token string">&#39;Morgan Freeman&#39;</span>, <span class="token string">&#39;Brad Pitt&#39;</span>,  <span class="token string">&#39;Kevin Spacey&#39;</span><span class="token punctuation">]</span>,
   tags: <span class="token punctuation">[</span><span class="token string">&#39;drama&#39;</span>,<span class="token string">&#39;mystery&#39;</span>,<span class="token string">&#39;thiller&#39;</span><span class="token punctuation">]</span>,
   debut: new Date<span class="token punctuation">(</span><span class="token number">1995,9</span>,22,0,0<span class="token punctuation">)</span>,
   likes: <span class="token number">134370</span>,
   dislikes: <span class="token number">1037</span>,
   comments: <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
         user:<span class="token string">&#39;user3&#39;</span>,
         message: <span class="token string">&#39;Love Kevin Spacey&#39;</span>,
         dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2002,09</span>,13,2,35<span class="token punctuation">)</span>,
         like: <span class="token number">0</span>
      <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span>
         user:<span class="token string">&#39;user2&#39;</span>,
         message: <span class="token string">&#39;Good works!&#39;</span>,
         dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2013,10</span>,21,6,20<span class="token punctuation">)</span>,
         like: <span class="token number">14</span>
      <span class="token punctuation">}</span>,
      <span class="token punctuation">{</span>
         user:<span class="token string">&#39;user7&#39;</span>,
         message: <span class="token string">&#39;Good Movie!&#39;</span>,
         dateCreated: new Date<span class="token punctuation">(</span><span class="token number">2009,10</span>,11,6,20<span class="token punctuation">)</span>,
         like: <span class="token number">2</span>
      <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>顺利的话会显示：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>BulkWriteResult<span class="token punctuation">(</span><span class="token punctuation">{</span>
   <span class="token string">&quot;writeErrors&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>,
   <span class="token string">&quot;writeConcernErrors&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>,
   <span class="token string">&quot;nInserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span>,
   <span class="token string">&quot;nUpserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
   <span class="token string">&quot;nMatched&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
   <span class="token string">&quot;nModified&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
   <span class="token string">&quot;nRemoved&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">0</span>,
   <span class="token string">&quot;upserted&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>表面我们成功地插入了两个数据。注意批量插入的格式是这样的：<code>db.movie.insert([{ITEM1},{ITEM2}])</code>。几部电影的外面需要用 [] 括起来。</p><p>请注意，虽然 collection 的插入不需要先声明，但表达相同意思的 key，名字要一样，比如，如果我们在一个文档里用<code>directed_by</code>来表示导演，则在其它文档也要保持同样的名字(而不是<code>director</code>之类的)。不同的名字不是不可以，技术上完全可行，但会给查询和更新带来困难。</p><p>好了，到这里，我们就有了一个叫 tutorial 的数据库，里面有一个叫 movie 的集合，而 movie 里面有三个记录。接下来我们就可以对其进行查询了。</p><h3 id="查询" tabindex="-1"><a class="header-anchor" href="#查询"><span>查询</span></a></h3><p>在上一节我们已经接触到最简单的查询<code>db.movie.find().pretty()</code>。MongoDB 支持各种各样的深度查询功能。先来一个最简单的例子，找出大卫芬奇 (David Fincher) 导演的所有电影：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;directed_by&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;David Fincher&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将返回《搏击俱乐部》和《七宗罪》两部电影。这种搜索和 SQL 的<code>WHERE</code>语句是很相似的。</p><p>也可以设置多个条件。比如找出大卫芬奇导演的，摩根弗里曼主演的电影：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;directed_by&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;David Fincher&#39;</span>, <span class="token string">&#39;stars&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Morgan Freeman&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里两个条件之间，是 AND 的关系，只有同时满足两个条件的电影才会被输出。同理，可以设置多个的条件，不赘述。</p><p>条件之间也可以是或的关系，比如找出罗宾怀特或摩根弗里曼主演的电影：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span>
<span class="token punctuation">{</span>
  <span class="token variable">$or</span><span class="token builtin class-name">:</span>
     <span class="token punctuation">[</span>  <span class="token punctuation">{</span><span class="token string">&#39;stars&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Robin Wright&#39;</span><span class="token punctuation">}</span>,
        <span class="token punctuation">{</span><span class="token string">&#39;stars&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Morgan Freeman&#39;</span><span class="token punctuation">}</span>
     <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这里面稍显复杂的各种括号。</p><p>还可以设置一个范围的搜索，比如找出 50 万人以上赞的电影：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;likes&#39;</span>:<span class="token punctuation">{</span><span class="token variable">$gt</span>:500000<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>同样要注意略复杂的括号。注意，在这些查询里，key 的单引号都是可选的，也就是说，上述语句也可以写成：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span>likes:<span class="token punctuation">{</span><span class="token variable">$gt</span>:500000<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>类似地，少于二十万人赞的电影：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span>likes:<span class="token punctuation">{</span><span class="token variable">$lt</span>:200000<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>类似的运算符还有：<code>$let</code>: 小于或等于；<code>$get</code>: 大于或等于；<code>$ne</code>: 不等于。</p><p>注意，对于包含多个值的 key，同样可以用 find 来查询。比如：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;tags&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;romance&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将返回《阿甘正传》，虽然其标签既有 romance，又有 drama，但只要符合一个就可以了。</p><p>如果你确切地知道返回的结果只有一个，也可以用<code>findOne</code>:</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.findOne<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;title&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Forrest Gump&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果有多个结果，则会按磁盘存储顺序返回第一个。请注意，<code>findOne()</code>自带 pretty 模式，所以不能再加<code>pretty()</code>，将报错。</p><p>如果结果很多而你只想显示其中一部分，可以用<code>limit()</code>和<code>skip()</code>，前者指明输出的个数，后者指明从第二个结果开始数。比如：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>.skip<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>则跳过第一部，从第二部开始选取两部电影。</p><h3 id="局部查询" tabindex="-1"><a class="header-anchor" href="#局部查询"><span>局部查询</span></a></h3><p>第五节的时候我们讲了<code>find</code>的用法，但对于符合条件的条目，我们都是返回整个 JSON 文件的。这类似于 SQL 里面的<code>SELECT *</code>。有的时候，我们需要的，仅仅是部分数据，这个时候，<code>find</code>的局部查询的功能就派上用场了。先来看一个例子，返回 tags 为 drama 的电影的名字和首映日期。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;tags&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;drama&#39;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&#39;debut&#39;</span>:1,<span class="token string">&#39;title&#39;</span>:1<span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>数据库将返回：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;549cfb42f685c085f1dd47d4&quot;</span><span class="token punctuation">)</span>,
  <span class="token string">&quot;title&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Forrest Gump&quot;</span>,
  <span class="token string">&quot;debut&quot;</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">&quot;1994-08-05T16:00:00Z&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;549cff96f685c085f1dd47d6&quot;</span><span class="token punctuation">)</span>,
  <span class="token string">&quot;title&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Fight Club&quot;</span>,
  <span class="token string">&quot;debut&quot;</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">&quot;1999-11-14T16:00:00Z&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">&quot;549cff96f685c085f1dd47d7&quot;</span><span class="token punctuation">)</span>,
  <span class="token string">&quot;title&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Seven&quot;</span>,
  <span class="token string">&quot;debut&quot;</span> <span class="token builtin class-name">:</span> ISODate<span class="token punctuation">(</span><span class="token string">&quot;1995-10-21T16:00:00Z&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里 find 的第二个参数是用来控制输出的，1 表示要返回，而 0 则表示不返回。默认值是 0，但<code>_id</code>是例外，因此如果你不想输出<code>_id</code>，需要显式地声明：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;tags&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;drama&#39;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&#39;debut&#39;</span>:1,<span class="token string">&#39;title&#39;</span>:1,<span class="token string">&#39;_id&#39;</span>:0<span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="更新" tabindex="-1"><a class="header-anchor" href="#更新"><span>更新</span></a></h3><p>很多情况下你需要更新你的数据库，比如有人对某部电影点了个赞，那么你需要更新相应的数据库。比如有人对《七宗罪》点了个赞，而它本来的赞的个数是 134370，那么你需要更新到 134371。可以这样操作：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token string">&#39;Seven&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>likes:134371<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>第一个大括号里表明要选取的对象，第二个表明要改动的数据。请注意上述的操作相当不现实，因为你首先要知道之前的数字是多少，然后加一，但通常你不读取数据库的话，是不会知道这个数 (134370) 的。MongoDB 提供了一种简便的方法，可以对现有条目进行增量操作。假设又有人对《七宗罪》点了两个赞，则可以：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token string">&#39;Seven&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token variable">$inc</span>:<span class="token punctuation">{</span>likes:2<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果你查询的话，会发现点赞数变为 134373 了，这里用的是<code>$inc</code>。除了增量更新，MongoDB 还提供了很多灵活的更新选项，具体可以看：<a href="http://docs.mongodb.org/manual/reference/operator/update-field/" target="_blank" rel="noopener noreferrer">http://docs.mongodb.org/manual/reference/operator/update-field/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 。</p><p>注意如果有多部符合要求的电影。则默认只会更新第一个。如果要多个同时更新，要设置<code>{multi:true}</code>，像下面这样：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token variable">$inc</span>:<span class="token punctuation">{</span>likes:10<span class="token punctuation">}</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span>multi:true<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>所有电影的赞数都多了 10.</p><p>注意，以上的更新操作会替换掉原来的值，所以如果你是想在原有的值得基础上增加一个值的话，则应该用<code>$push</code>，比如，为《七宗罪》添加一个 popular 的 tags。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;title&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Seven&#39;</span><span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token variable">$push</span>:<span class="token punctuation">{</span><span class="token string">&#39;tags&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;popular&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>你会发现《七宗罪》现在有四个标签：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>  <span class="token string">&quot;tags&quot;</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;drama&quot;</span>,
    <span class="token string">&quot;mystery&quot;</span>,
    <span class="token string">&quot;thiller&quot;</span>,
    <span class="token string">&quot;popular&quot;</span>
  <span class="token punctuation">]</span>,

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="删除" tabindex="-1"><a class="header-anchor" href="#删除"><span>删除</span></a></h3><p>删除的句法和 find 很相似，比如，要删除标签为 romance 的电影，则：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.remove<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;tags&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;romance&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>考虑到我们数据库条目异常稀少，就不建议你执行这条命令了~</p><p>注意，上面的例子会删除所有标签包含 romance 的电影。如果你只想删除第一个，则</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.remove<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;tags&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;romance&#39;</span><span class="token punctuation">}</span>,1<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>如果不加任何限制：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.remove<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>会删除 movie 这个集合下的所有文档。</p><h3 id="索引和排序" tabindex="-1"><a class="header-anchor" href="#索引和排序"><span>索引和排序</span></a></h3><p>为文档中的一些 key 加上索引 (index) 可以加快搜索速度。这一点不难理解，假如没有没有索引，我们要查找名字为 Seven 的电影，就必须在所有文档里逐个搜索。而如果对名字这个 key 加上索引值，则电影名这个字符串和数字建立了映射，这样在搜索的时候就会快很多。排序的时候也是如此，不赘述。MongoDB 里面为某个 key 加上索引的方式很简单，比如我们要对导演这个 key 加索引，则可以：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.ensureIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>directed_by:1<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里的 1 是升序索引，如果要降序索引，用-1。</p><p>MongoDB 支持对输出进行排序，比如按名字排序：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.sort<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&#39;title&#39;</span>:1<span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>同样地，1 是升序，-1 是降序。默认是 1。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将返回所有索引，包括其名字。</p><p>而</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.dropIndex<span class="token punctuation">(</span><span class="token string">&#39;index_name&#39;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将删除对应的索引。</p><h3 id="_11-聚合" tabindex="-1"><a class="header-anchor" href="#_11-聚合"><span>11. 聚合</span></a></h3><p>MongoDB 支持类似于 SQL 里面的<code>GROUP BY</code>操作。比如当有一张学生成绩的明细表时，我们可以找出每个分数段的学生各有多少。为了实现这个操作，我们需要稍加改动我们的数据库。执行以下三条命令：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token string">&#39;Seven&#39;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>grade:1<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token string">&#39;Forrest Gump&#39;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>grade:1<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db.movie.update<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token string">&#39;Fight Club&#39;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token variable">$set</span>:<span class="token punctuation">{</span>grade:2<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这几条是给每部电影加一个虚拟的分级，前两部是归类是一级，后一部是二级。</p><p>这里你也可以看到 MongoDB 的强大之处：可以动态地后续添加各种新项目。</p><p>我们先通过聚合来找出总共有几种级别。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">&#39;$grade&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输出：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这里的 2 和 1 是指级别，而不是每个级别的电影数。这个例子看得清楚些：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">&#39;$directed_by&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这里按照导演名字进行聚合。输出：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;David Fincher&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Robert Zemeckis&quot;</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>接着我们要找出，每个导演的电影数分别有多少：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">&#39;$directed_by&#39;</span>,num_movie:<span class="token punctuation">{</span><span class="token variable">$sum</span>:1<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>将会输出：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;David Fincher&quot;</span>, <span class="token string">&quot;num_movie&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Robert Zemeckis&quot;</span>, <span class="token string">&quot;num_movie&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意$sum 后面的 1 表示只是把电影数加起来，但我们也可以统计别的数据，比如两位导演谁的赞比较多：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code> db.movie.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">&#39;$directed_by&#39;</span>,num_likes:<span class="token punctuation">{</span><span class="token variable">$sum</span><span class="token builtin class-name">:</span><span class="token string">&#39;$likes&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>输出：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;David Fincher&quot;</span>, <span class="token string">&quot;num_likes&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">358753</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string">&quot;_id&quot;</span> <span class="token builtin class-name">:</span> <span class="token string">&quot;Robert Zemeckis&quot;</span>, <span class="token string">&quot;num_likes&quot;</span> <span class="token builtin class-name">:</span> <span class="token number">864377</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这些数据都纯属虚构啊！</p><p>除了<code>$sum</code>，还有其它一些操作。比如：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">&#39;$directed_by&#39;</span>,num_movie:<span class="token punctuation">{</span><span class="token variable">$avg</span><span class="token builtin class-name">:</span><span class="token string">&#39;$likes&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>统计平均的赞。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token variable">$group</span>:<span class="token punctuation">{</span>_id:<span class="token string">&#39;$directed_by&#39;</span>,num_movie:<span class="token punctuation">{</span><span class="token variable">$first</span><span class="token builtin class-name">:</span><span class="token string">&#39;$likes&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>返回每个导演的电影中的第一部的赞数。</p><p>其它各种操作可以参考：<a href="http://docs.mongodb.org/manual/reference/operator/aggregation/group/" target="_blank" rel="noopener noreferrer">http://docs.mongodb.org/manual/reference/operator/aggregation/group/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h3 id="all-or-nothing" tabindex="-1"><a class="header-anchor" href="#all-or-nothing"><span>All or Nothing</span></a></h3><p>MongoDB 支持单个文档内的原子化操作 (atomic operation)，这是说，可以将多条关于同一个文档的指令放到一起，他们要么一起执行，要么都不执行。而不会执行到一半。有些场合需要确保多条执行一起顺次执行。比如一个场景：一个电商网站，用户查询某种商品的剩余数量，以及用户购买该种商品，这两个操作，必须放在一起执行。不然的话，假定我们先执行剩余数量的查询，这是假定为 1，用户接着购买，但假如这两个操作之间还加入了其它操作，比如另一个用户抢先购买了，那么原先购买用户的购买的行为就会造成数据库的错误，因为实际上这种商品以及没有存货了。但因为查询剩余数量和购买不是在一个“原子化操作”之内，因此会发生这样的错误 <a href="http://docs.mongodb.org/manual/reference/operator/aggregation/group/" target="_blank" rel="noopener noreferrer">http://www.tutorialspoint.com/mongodb/mongodb_atomic_operations.htm<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><p>MongoDB 提供了<code>findAndModify</code>的方法来确保 atomic operation。比如这样的：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.findAndModify<span class="token punctuation">(</span>
      <span class="token punctuation">{</span>
      query:<span class="token punctuation">{</span><span class="token string">&#39;title&#39;</span><span class="token builtin class-name">:</span><span class="token string">&#39;Forrest Gump&#39;</span><span class="token punctuation">}</span>,
      update:<span class="token punctuation">{</span><span class="token variable">$inc</span>:<span class="token punctuation">{</span>likes:10<span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
          <span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>query 是查找出匹配的文档，和 find 是一样的，而 update 则是更新 likes 这个项目。注意由于 MongoDB 只支持单个文档的 atomic operation，因此如果 query 出多于一个文档，则只会对第一个文档进行操作。</p><p><code>findAndModify</code>还支持更多的操作，具体见：<a href="http://docs.mongodb.org/manual/reference/command/findAndModify/" target="_blank" rel="noopener noreferrer">http://docs.mongodb.org/manual/reference/command/findAndModify/<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。</p><h3 id="文本搜索" tabindex="-1"><a class="header-anchor" href="#文本搜索"><span>文本搜索</span></a></h3><p>除了前面介绍的各种深度查询功能，MongoDB 还支持文本搜索。对文本搜索之前，我们需要先对要搜索的 key 建立一个 text 索引。假定我们要对标题进行文本搜索，我们可以先这样：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.ensureIndex<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token string">&#39;text&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>接着我们就可以对标题进行文本搜索了，比如，查找带有&quot;Gump&quot;的标题：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token variable">$text</span>:<span class="token punctuation">{</span><span class="token variable">$search</span><span class="token builtin class-name">:</span><span class="token string">&quot;Gump&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注意 text 和 search 前面的$符号。</p><p>这个例子里，文本搜索作用不是非常明显。但假设我们要搜索的 key 是一个长长的文档，这种 text search 的方便性就显现出来了。MongoDB 目前支持 15 种语言的文本搜索。</p><h3 id="正则表达式" tabindex="-1"><a class="header-anchor" href="#正则表达式"><span>正则表达式</span></a></h3><p>MongoDB 还支持基于正则表达式的查询。如果不知道正则表达式是什么，可以参考 <a href="http://en.wikipedia.org/wiki/Regular_expression" target="_blank" rel="noopener noreferrer">Wikipedia<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>。这里简单举几个例子。比如，查找标题以<code>b</code>结尾的电影信息：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token punctuation">{</span><span class="token variable">$regex</span><span class="token builtin class-name">:</span><span class="token string">&#39;.*b$&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>也可以写成：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span>title:/.*b$/<span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>查找含有&#39;Fight&#39;标题的电影：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span>title:/Fight/<span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>注意以上匹配都是区分大小写的，如果你要让其不区分大小写，则可以：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>db.movie.find<span class="token punctuation">(</span><span class="token punctuation">{</span>title:<span class="token punctuation">{</span><span class="token variable">$regex</span><span class="token builtin class-name">:</span><span class="token string">&#39;fight.*b&#39;</span>,<span class="token variable">$options</span><span class="token builtin class-name">:</span><span class="token string">&#39;$i&#39;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>$i</code>是 insensitive 的意思。这样的话，即使是小写的 fight，也能搜到了。</p><h3 id="后记" tabindex="-1"><a class="header-anchor" href="#后记"><span>后记</span></a></h3><p>至此，MongoDB 的最基本的内容就介绍得差不多了。如果有什么遗漏的以后我会补上來。如果你一路看到底完全了这个入门教程，恭喜你，你一定是一个有毅力的人。</p><p>把这个文档过一遍，不会让你变成一个 MongoDB 的专家(如果会那就太奇怪了)。但如果它能或多或少减少你上手的时间，或者让你意识到“咦，MongoDB 其实没那么复杂”，那么这个教程的目的也就达到啦。</p><p>这个文档是匆忙写就的，出错简直是一定的。如果您发现了任何错误或者有关于本文的任何建议，麻烦发邮件给我(stevenslxie at gmail.com)或者在 GitHub 上直接交流，不胜感激。</p><h3 id="转载声明" tabindex="-1"><a class="header-anchor" href="#转载声明"><span>转载声明</span></a></h3><p>原作者 StevenSLXie</p><p>原链接 <a href="https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md" target="_blank" rel="noopener noreferrer">https://github.com/StevenSLXie/Tutorials-for-Web-Developers/blob/master/MongoDB%20%E6%9E%81%E7%AE%80%E5%AE%9E%E8%B7%B5%E5%85%A5%E9%97%A8.md<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Last Updated 5/22/2024, 6:48:58 AM<!--]--></span></span></div></footer><!----><div class="reco-waline-wrapper"><div data-waline hidecomments="false" pageview="false"><!--v-if--><div class="wl-comment"><!--v-if--><div class="wl-panel"><div class="wl-header item3"><!--[--><div class="wl-header-item"><label for="wl-nick">NickName</label><input id="wl-nick" class="wl-input wl-nick" name="nick" type="text" value></div><div class="wl-header-item"><label for="wl-mail">E-Mail</label><input id="wl-mail" class="wl-input wl-mail" name="mail" type="email" value></div><div class="wl-header-item"><label for="wl-link">Website</label><input id="wl-link" class="wl-input wl-link" name="link" type="text" value></div><!--]--></div><textarea id="wl-edit" class="wl-editor" placeholder="Comment here..."></textarea><div class="wl-preview" style="display:none;"><hr><h4>Preview:</h4><div class="wl-content"></div></div><div class="wl-footer"><div class="wl-actions"><a href="https://guides.github.com/features/mastering-markdown/" title="Markdown Guide" aria-label="Markdown is supported" class="wl-action" target="_blank" rel="noopener noreferrer"><svg width="16" height="16" ariaHidden="true"><path d="M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z" fill="currentColor"></path></svg></a><button type="button" class="wl-action" title="Emoji" style="display:none;"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M563.2 463.3 677 540c1.7 1.2 3.7 1.8 5.8 1.8.7 0 1.4-.1 2-.2 2.7-.5 5.1-2.1 6.6-4.4l25.3-37.8c1.5-2.3 2.1-5.1 1.6-7.8s-2.1-5.1-4.4-6.6l-73.6-49.1 73.6-49.1c2.3-1.5 3.9-3.9 4.4-6.6.5-2.7 0-5.5-1.6-7.8l-25.3-37.8a10.1 10.1 0 0 0-6.6-4.4c-.7-.1-1.3-.2-2-.2-2.1 0-4.1.6-5.8 1.8l-113.8 76.6c-9.2 6.2-14.7 16.4-14.7 27.5.1 11 5.5 21.3 14.7 27.4zM387 348.8h-45.5c-5.7 0-10.4 4.7-10.4 10.4v153.3c0 5.7 4.7 10.4 10.4 10.4H387c5.7 0 10.4-4.7 10.4-10.4V359.2c0-5.7-4.7-10.4-10.4-10.4zm333.8 241.3-41-20a10.3 10.3 0 0 0-8.1-.5c-2.6.9-4.8 2.9-5.9 5.4-30.1 64.9-93.1 109.1-164.4 115.2-5.7.5-9.9 5.5-9.5 11.2l3.9 45.5c.5 5.3 5 9.5 10.3 9.5h.9c94.8-8 178.5-66.5 218.6-152.7 2.4-5 .3-11.2-4.8-13.6zm186-186.1c-11.9-42-30.5-81.4-55.2-117.1-24.1-34.9-53.5-65.6-87.5-91.2-33.9-25.6-71.5-45.5-111.6-59.2-41.2-14-84.1-21.1-127.8-21.1h-1.2c-75.4 0-148.8 21.4-212.5 61.7-63.7 40.3-114.3 97.6-146.5 165.8-32.2 68.1-44.3 143.6-35.1 218.4 9.3 74.8 39.4 145 87.3 203.3.1.2.3.3.4.5l36.2 38.4c1.1 1.2 2.5 2.1 3.9 2.6 73.3 66.7 168.2 103.5 267.5 103.5 73.3 0 145.2-20.3 207.7-58.7 37.3-22.9 70.3-51.5 98.1-85 27.1-32.7 48.7-69.5 64.2-109.1 15.5-39.7 24.4-81.3 26.6-123.8 2.4-43.6-2.5-87-14.5-129zm-60.5 181.1c-8.3 37-22.8 72-43 104-19.7 31.1-44.3 58.6-73.1 81.7-28.8 23.1-61 41-95.7 53.4-35.6 12.7-72.9 19.1-110.9 19.1-82.6 0-161.7-30.6-222.8-86.2l-34.1-35.8c-23.9-29.3-42.4-62.2-55.1-97.7-12.4-34.7-18.8-71-19.2-107.9-.4-36.9 5.4-73.3 17.1-108.2 12-35.8 30-69.2 53.4-99.1 31.7-40.4 71.1-72 117.2-94.1 44.5-21.3 94-32.6 143.4-32.6 49.3 0 97 10.8 141.8 32 34.3 16.3 65.3 38.1 92 64.8 26.1 26 47.5 56 63.6 89.2 16.2 33.2 26.6 68.5 31 105.1 4.6 37.5 2.7 75.3-5.6 112.3z" fill="currentColor"></path></svg></button><button type="button" class="wl-action" title="GIF"><svg width="24" height="24" fill="currentcolor" viewBox="0 0 24 24"><path style="transform: translateY(0.5px)" d="M18.968 10.5H15.968V11.484H17.984V12.984H15.968V15H14.468V9H18.968V10.5V10.5ZM8.984 9C9.26533 9 9.49967 9.09367 9.687 9.281C9.87433 9.46833 9.968 9.70267 9.968 9.984V10.5H6.499V13.5H8.468V12H9.968V14.016C9.968 14.2973 9.87433 14.5317 9.687 14.719C9.49967 14.9063 9.26533 15 8.984 15H5.984C5.70267 15 5.46833 14.9063 5.281 14.719C5.09367 14.5317 5 14.2973 5 14.016V9.985C5 9.70367 5.09367 9.46933 5.281 9.282C5.46833 9.09467 5.70267 9.001 5.984 9.001H8.984V9ZM11.468 9H12.968V15H11.468V9V9Z"></path><path d="M18.5 3H5.75C3.6875 3 2 4.6875 2 6.75V18C2 20.0625 3.6875 21.75 5.75 21.75H18.5C20.5625 21.75 22.25 20.0625 22.25 18V6.75C22.25 4.6875 20.5625 3 18.5 3ZM20.75 18C20.75 19.2375 19.7375 20.25 18.5 20.25H5.75C4.5125 20.25 3.5 19.2375 3.5 18V6.75C3.5 5.5125 4.5125 4.5 5.75 4.5H18.5C19.7375 4.5 20.75 5.5125 20.75 6.75V18Z"></path></svg></button><input id="wl-image-upload" class="upload" type="file" accept=".png,.jpg,.jpeg,.webp,.bmp,.gif"><label for="wl-image-upload" class="wl-action" title="Upload Image"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M784 112H240c-88 0-160 72-160 160v480c0 88 72 160 160 160h544c88 0 160-72 160-160V272c0-88-72-160-160-160zm96 640c0 52.8-43.2 96-96 96H240c-52.8 0-96-43.2-96-96V272c0-52.8 43.2-96 96-96h544c52.8 0 96 43.2 96 96v480z" fill="currentColor"></path><path d="M352 480c52.8 0 96-43.2 96-96s-43.2-96-96-96-96 43.2-96 96 43.2 96 96 96zm0-128c17.6 0 32 14.4 32 32s-14.4 32-32 32-32-14.4-32-32 14.4-32 32-32zm462.4 379.2-3.2-3.2-177.6-177.6c-25.6-25.6-65.6-25.6-91.2 0l-80 80-36.8-36.8c-25.6-25.6-65.6-25.6-91.2 0L200 728c-4.8 6.4-8 14.4-8 24 0 17.6 14.4 32 32 32 9.6 0 16-3.2 22.4-9.6L380.8 640l134.4 134.4c6.4 6.4 14.4 9.6 24 9.6 17.6 0 32-14.4 32-32 0-9.6-4.8-17.6-9.6-24l-52.8-52.8 80-80L769.6 776c6.4 4.8 12.8 8 20.8 8 17.6 0 32-14.4 32-32 0-8-3.2-16-8-20.8z" fill="currentColor"></path></svg></label><button type="button" class="wl-action" title="Preview"><svg viewBox="0 0 1024 1024" width="24" height="24"><path d="M710.816 654.301c70.323-96.639 61.084-230.578-23.705-314.843-46.098-46.098-107.183-71.109-172.28-71.109-65.008 0-126.092 25.444-172.28 71.109-45.227 46.098-70.756 107.183-70.756 172.106 0 64.923 25.444 126.007 71.194 172.106 46.099 46.098 107.184 71.109 172.28 71.109 51.414 0 100.648-16.212 142.824-47.404l126.53 126.006c7.058 7.06 16.297 10.979 26.406 10.979 10.105 0 19.343-3.919 26.402-10.979 14.467-14.467 14.467-38.172 0-52.723L710.816 654.301zm-315.107-23.265c-65.88-65.88-65.88-172.54 0-238.42 32.069-32.07 74.245-49.149 119.471-49.149 45.227 0 87.407 17.603 119.472 49.149 65.88 65.879 65.88 172.539 0 238.42-63.612 63.178-175.242 63.178-238.943 0zm0 0" fill="currentColor"></path><path d="M703.319 121.603H321.03c-109.8 0-199.469 89.146-199.469 199.38v382.034c0 109.796 89.236 199.38 199.469 199.38h207.397c20.653 0 37.384-16.645 37.384-37.299 0-20.649-16.731-37.296-37.384-37.296H321.03c-68.582 0-124.352-55.77-124.352-124.267V321.421c0-68.496 55.77-124.267 124.352-124.267h382.289c68.582 0 124.352 55.771 124.352 124.267V524.72c0 20.654 16.736 37.299 37.385 37.299 20.654 0 37.384-16.645 37.384-37.299V320.549c-.085-109.8-89.321-198.946-199.121-198.946zm0 0" fill="currentColor"></path></svg></button></div><div class="wl-info"><div class="wl-captcha-container"></div><div class="wl-text-number">0 <!--v-if-->  Words</div><button type="button" class="wl-btn">Login</button><button type="submit" class="primary wl-btn" title="Cmd|Ctrl + Enter"><!--[-->Submit<!--]--></button></div><div class="wl-gif-popup"><input type="text" placeholder="Search GIF"><!--v-if--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div></div><div class="wl-emoji-popup"><!--[--><!--]--><!--v-if--></div></div></div><!--v-if--></div><div class="wl-meta-head"><div class="wl-count"><!--v-if--> Comments</div><ul class="wl-sort"><!--[--><li class="active">Latest</li><li class="">Oldest</li><li class="">Hottest</li><!--]--></ul></div><div class="wl-cards"><!--[--><!--]--></div><!--[--><div class="wl-loading"><svg width="30" height="30" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" fill="none" stroke="currentColor" strokeWidth="4" r="40" stroke-dasharray="85 30"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" values="0 50 50;360 50 50" keyTimes="0;1"></animateTransform></circle></svg></div><!--]--><div class="wl-power"> Powered by <a href="https://github.com/walinejs/waline" target="_blank" rel="noopener noreferrer"> Waline </a> v2.15.8</div></div></div></main><!--]--><div class="page-catalog-container"><h5 class="tip">导航条</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#为什么用-mongodb" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="为什么用 MongoDB"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->为什么用 MongoDB<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#文章目的" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="文章目的"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->文章目的<!--]--></span></span><!--[--><!--]--></a></li><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#安装与环境" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="安装与环境"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->安装与环境<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#创建集合和删除集合" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="创建集合和删除集合"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->创建集合和删除集合<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#插入" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="插入"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->插入<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#查询" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="查询"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->查询<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#局部查询" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="局部查询"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->局部查询<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#更新" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="更新"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->更新<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#删除" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="删除"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->删除<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#索引和排序" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="索引和排序"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->索引和排序<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#_11-聚合" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="11. 聚合"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->11. 聚合<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#all-or-nothing" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="All or Nothing"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->All or Nothing<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#文本搜索" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="文本搜索"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->文本搜索<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#正则表达式" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="正则表达式"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->正则表达式<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#后记" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="后记"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->后记<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_3"><a aria-current="page" href="/blogs/frontend-tech-institute/2017-09-17.html#转载声明" class="router-link-active router-link-exact-active link page-catalog-item page-catalog-item" aria-label="转载声明"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->转载声明<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--><!--]--></ul></div></div></div><!--[--><!----><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BgGkuvCY.js" defer></script>
  </body>
</html>
